/**
 * GulpPress Configuration File
 *
 * @package GulpPress
 */

import { gulppress } from '@gulppress/scripts';

const basePath = '{{basePath}}';

// Browsers to consider for autoprefixing (https://github.com/ai/browserslist)
// The following list is set as per WordPress requirements:
// https://github.com/WordPress/gutenberg/tree/master/packages/browserslist-config
const browserList = [
  '> 1%',
  'ie >= 11',
  'last 1 Android versions',
  'last 1 ChromeAndroid versions',
  'last 2 Chrome versions',
  'last 2 Firefox versions',
  'last 2 Safari versions',
  'last 2 iOS versions',
  'last 2 Edge versions',
  'last 2 Opera versions',
];

const config: gulppress.MainConfig = {
  // Project Options
  project: {
    basePath,
    envFile: '{{dotEnvPath}}',{{#if environment}}{{{environment}}}{{/if}}
    createSeparateMinFiles: {{createSeparateMinFiles}},
  },
  // Script Options
  scripts: {
    src: `${basePath}{{srcStructure}}/scripts/*.+(js|ts)`,
    dest: `${basePath}{{distStructure}}/scripts`,
    watch: `${basePath}{{distStructure}}/scripts/**/*.js`,
    targets: browserList,
  },
  // Style options
  styles: {
    src: `${basePath}{{srcStructure}}/styles/*.scss`,
    dest: `${basePath}{{distStructure}}/styles`,
    watch: `${basePath}{{srcStructure}}/styles/**/*.scss`,
    // Available autoprefixer options: https://github.com/postcss/autoprefixer#options
    autoprefixerOptions: {
      overrideBrowserslist: browserList,
    },
    postcssPlugins: [],
    // Available node-sass options: https://github.com/sass/node-sass#options
    sassOptions: {
      includePaths: [
        'node_modules',
      ],
      outputStyle: 'expanded'
    },
  },
  // Favicon options
  favicon: {
    src: `${basePath}{{srcStructure}}/favicon/favicon.+(ico|png)`,
    dest: `${basePath}{{distStructure}}/favicon`,
  },
  // Font options
  fonts: {
    srcPath: `${basePath}{{srcStructure}}/fonts`,
    src: `${basePath}{{srcStructure}}/fonts/*.+(ttf|woff|woff2)`,
    dest: `${basePath}{{distStructure}}/fonts`,
  },
  // Icon options
  icons: {
    src: `${basePath}{{srcStructure}}/icons/**/*.svg`,
    dest: `${basePath}{{distStructure}}/icons`,
    destPhpPartials: `${basePath}/template-parts/svg-icons`,
  },
  // Image options
  images: {
    src: `${basePath}{{srcStructure}}/images/**/*.+(jpg|jpeg|png|svg)`,
    dest: `${basePath}{{distStructure}}/images`,
    destPhpPartials: `${basePath}/template-parts/svg-images`,
  },
  // Translation optione
  translation: {
    src: `${basePath}/**/*.php`,
    dest: `${basePath}/languages/{{appName}}.pot`,
    // Available gulp-wp-pot options: https://github.com/wp-pot/wp-pot#options
    wpPotOptions: {
      domain: '{{appName}}',
      package: '{{appName}}',
    },
  },
  // Vendor scripts options
  vendorScripts: {
    packages: [
			'jquery'
		],
    dest: `${basePath}{{distStructure}}/scripts/vendor`,
  },
};

export default config;
