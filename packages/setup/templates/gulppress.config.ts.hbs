/* eslint-disable import/no-extraneous-dependencies */

/**
 * GulpPress Configuration File
 *
 * @package GulpPress
 */

import { gulppress } from '@gulppress/scripts';

const basePath = '{{basePath}}';

// Browsers to consider for autoprefixing (https://github.com/ai/browserslist)
// The following list is set as per WordPress requirements:
// https://github.com/WordPress/gutenberg/tree/master/packages/browserslist-config
const browserList = [
  '> 1%',
  'ie >= 11',
  'last 1 Android versions',
  'last 1 ChromeAndroid versions',
  'last 2 Chrome versions',
  'last 2 Firefox versions',
  'last 2 Safari versions',
  'last 2 iOS versions',
  'last 2 Edge versions',
  'last 2 Opera versions',
];

const mainConfig: gulppress.ProjectConfig = {
  // Base Options
  base: {
    envFile: '{{dotEnvPath}}',{{#if environment}}{{{environment}}}{{/if}}
    createSeparateMinFiles: {{createSeparateMinFiles}},
  },
  // Script Options
  scripts: {{#if_feature "scripts"}}{
    src: `${basePath}{{srcStructure}}/scripts/*.+(js|ts)`,
    dest: `${basePath}{{distStructure}}/scripts`,
    watch: `${basePath}{{distStructure}}/scripts/**/*.js`,
    targets: browserList,
  }{{else}}null{{/if_feature}},
  // Style options
  styles: {{#if_feature "styles"}}{
    src: `${basePath}{{srcStructure}}/styles/*.scss`,
    dest: `${basePath}{{distStructure}}/styles`,
    watch: `${basePath}{{srcStructure}}/styles/**/*.scss`,
    // Available autoprefixer options: https://github.com/postcss/autoprefixer#options
    autoprefixerOptions: {
      overrideBrowserslist: browserList,
    },
    postcssPlugins: [],
    // Available node-sass options: https://github.com/sass/node-sass#options
    sassOptions: {
      includePaths: [
        'node_modules',
      ],
      outputStyle: 'expanded',
    },
  }{{else}}null{{/if_feature}},
  // Favicon options
  favicon: {{#if_feature "favicon"}}{
    src: `${basePath}{{srcStructure}}/favicon/favicon.png`,
    dest: `${basePath}{{distStructure}}/favicon`,
    sizes: [
      16, // Old browsers
      32, // Standard for most desktop browsers
      { size: 120, rename: 'apple-touch-icon.png' }, // iPhone old
      128, // Chrome Web Store icon & Small Windows 8 Star Screen Icon*
      { size: 152, rename: 'apple-touch-icon-ipad.png' }, // iPad
      { size: 167, rename: 'apple-touch-icon-ipad-retina.png' }, // iPad Retina
      { size: 180, rename: 'apple-touch-icon-iphone-retina.png' }, // iPhone Retina
      192, // Google Developer Web App Manifest Recommendation
      196, // Chrome for Android home screen icon
    ],
  }{{else}}null{{/if_feature}},
  // Font options
  fonts: {{#if_feature "fonts"}}{
    srcPath: `${basePath}{{srcStructure}}/fonts`,
    src: `${basePath}{{srcStructure}}/fonts/*.+(ttf|woff|woff2)`,
    dest: `${basePath}{{distStructure}}/fonts`,
  }{{else}}null{{/if_feature}},
  // Icon options
  icons: {{#if_feature "icons"}}{
    src: `${basePath}{{srcStructure}}/icons/**/*.svg`,
    dest: `${basePath}{{distStructure}}/icons`,
    destPhpPartials: `${basePath}/template-parts/svg-icons`,
  }{{else}}null{{/if_feature}},
  // Image options
  images: {{#if_feature "images"}}{
    src: `${basePath}{{srcStructure}}/images/**/*.+(jpg|jpeg|png|svg)`,
    dest: `${basePath}{{distStructure}}/images`,
    destPhpPartials: `${basePath}/template-parts/svg-images`,
  }{{else}}null{{/if_feature}},
  // Translation options
  translation: {{#if_feature "translation"}}{
    src: `${basePath}/**/*.php`,
    dest: `${basePath}/languages/{{domain}}.pot`,
    // Available gulp-wp-pot options: https://github.com/wp-pot/wp-pot#options
    wpPotOptions: {
      domain: '{{domain}}',
      package: '{{projectName}}',
    },
  }{{else}}null{{/if_feature}},
  // Vendor scripts options
  vendorScripts: {{#if_feature "vendorScripts"}}{
    packages: [
      'jquery',
    ],
    dest: `${basePath}{{distStructure}}/scripts/vendor`,
  }{{else}}null{{/if_feature}},
};

export default mainConfig;

export { basePath };
