/**
 * GulpPress Configuration File
 *
 * @package GulpPress
 */

import { gulppress } from '@gulppress/scripts';

const basePath = '{{basePath}}';

// Browsers to consider for autoprefixing (https://github.com/ai/browserslist)
// The following list is set as per WordPress requirements:
// https://github.com/WordPress/gutenberg/tree/master/packages/browserslist-config
const browserList = [
  '> 1%',
  'ie >= 11',
  'last 1 Android versions',
  'last 1 ChromeAndroid versions',
  'last 2 Chrome versions',
  'last 2 Firefox versions',
  'last 2 Safari versions',
  'last 2 iOS versions',
  'last 2 Edge versions',
  'last 2 Opera versions',
];

const config: gulppress.MainConfig = {
  // Project Options
  project: {
    basePath,
    envFile: '{{dotEnvPath}}',
		{{#if environment}}{{{environment}}}{{/if}}
    createSeparateMinFiles: {{createSeparateMinFiles}},
  },
  // Available browsersync options: https://www.browsersync.io/docs/options
  browserSync: {
    ghostMode: false,
    injectChanges: true,
    open: true,
		proxy: '{{projectURL}}',
    tunnel: false,
  },
  // Script Options
  scripts: {
    src: `${basePath}/assets/src/scripts/*.+(js|ts)`,
    dest: `${basePath}/assets/dist/scripts`,
    targets: browserList,
  },
  // Style options
  styles: {
    src: `${basePath}/assets/src/styles/*.scss`,
    dest: `${basePath}/assets/dist/styles`,
		// Available autoprefixer options: https://github.com/postcss/autoprefixer#options
    autoprefixerOptions: {
      overrideBrowserslist: browserList,
    },
    postcssPlugins: [],
		// Available node-sass options: https://github.com/sass/node-sass#options
    sassOptions: {
      includePaths: [
        './node_modules',
      ],
      outputStyle: 'nested',
      precision: 5,
    },
  },
  // Favicon options
  favicon: {
    src: `${basePath}/assets/src/favicon/favicon.+(ico|png)`,
    dest: `${basePath}/assets/dist/favicon`,
  },
  // Font options
  fonts: {
    srcPath: `${basePath}/assets/src/fonts`,
    src: `${basePath}/assets/src/fonts/*.+(ttf|woff|woff2)`,
    dest: `${basePath}/assets/dist/fonts`,
  },
  // Icon options
  icons: {
    src: `${basePath}/assets/src/icons/**/*.svg`,
    dest: `${basePath}/assets/dist/icons`,
    destPhpPartials: `${basePath}/template-parts/svg-icons`,
  },
  // Image options
  images: {
    src: `${basePath}/assets/src/images/**/*.+(jpg|jpeg|png|svg)`,
    dest: `${basePath}/assets/dist/images`,
    destPhpPartials: `${basePath}/template-parts/svg-images`,
  },
  // Translation optione
  translation: {
    src: `${basePath}/php/**/*.php`,
    dest: `${basePath}/assets/dist/gulppress.pot`,
		// Available gulp-wp-pot options: https://github.com/wp-pot/wp-pot#options
    wpPotOptions: {
      package: '{{appName}}',
    },
  },
};

export default config;
